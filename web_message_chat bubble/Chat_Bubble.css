/*
    ======= 全域變數（可依品牌調整） =======
    - --ease-back: 對應 Figma 的 Ease in and out back（彈性曲線）
    - --anim-delay / --anim-dur: 對應 Figma 的 Delay / Duration
  */
  :root{
    --chat-bg: #f6f7f9;          /* 聊天背景（灰） */
    --me-bg: #4f8cff;            /* 我方訊息背景（藍） */
    --me-fg: #fff;               /* 我方訊息文字 */
    --border: #e7e9ed;           /* 邊框色 */
    --ease-back: cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Figma: Ease in/out back */
    --anim-delay: 0.8s;   /* 進場延遲 800ms */
    --anim-dur:   0.5s;   /* 動畫時間 500ms */
    --radius: 16px;      /* 泡泡圓角 */
    --radius-lg: 18px;   /* 次要圓角 */
  }

  * { box-sizing: border-box; }
  html, body{ height:100%; }
  body{
    /* 基本文字與背景設定 */
    margin:0; background:var(--chat-bg); color:#0b0f18;
    font:16px/1.5 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", Arial, "Apple Color Emoji","Segoe UI Emoji";
  }

  /*
    ======= 版面容器 =======
    - 使用 CSS Grid 切成三列：Header / Thread / Input
    - 高度使用 100dvh 以適配行動裝置瀏覽器可視高度
  */
  .chat{
    max-width: 680px; margin:0 auto; height: 100dvh; display:grid; grid-template-rows:auto 1fr auto;
    border-left:1px solid var(--border); border-right:1px solid var(--border); background:#fff;
  }

  /* 標題列（固定在上方） */
  .chat__header{
    padding:12px 16px; border-bottom:1px solid var(--border); position:sticky; top:0; background:#fff; z-index:5;
    display:flex; align-items:center; gap:12px;
  }
  .chat__title{ font-weight:600; }

  /*
    訊息串區塊：自身滾動，避免推動底部輸入框
    - min-height:0 是讓 Grid 子元素正確吃到 1fr（避免被內容撐開）
  */
  .chat__thread{
    padding:16px; display:flex; flex-direction:column; gap:10px; background:var(--chat-bg); overflow:auto; min-height:0; scroll-behavior: smooth;
  }

  /* 訊息泡泡 */
  .msg{
    max-width: 76%;
    padding:10px 12px;
    border-radius: var(--radius);
    position:relative;
    word-wrap:break-word;
    box-shadow: 0 1px 0 rgba(0,0,0,.04);
  }
  .msg--them{
    align-self:flex-start; background:var(--them-bg); color:var(--them-fg);
    border-top-left-radius: 6px; border-bottom-left-radius: var(--radius-lg);
  }
  .msg--me{
    align-self:flex-end; background:var(--me-bg); color:var(--me-fg);
    border-top-right-radius: 6px; border-bottom-right-radius: var(--radius-lg);
  }

  .msg__meta{ margin-top:6px; font-size:12px; opacity:.6; }

  /*
    ======= 進場動畫 =======
    - 右側（我方）與左側（對方）各一套
    - 彈性進場 + 輕微縮放，營造 Smart Animate 感
  */
  @keyframes messageInRight {
    0%   { opacity:0; transform: translateY(20px) translateX(12px) scale(.92); }
    80%  { opacity:1; transform: translateY(-2px) translateX(0)    scale(1.05); }
    100% { opacity:1; transform: translateY(0)    translateX(0)    scale(1); }
  }
  @keyframes messageInLeft {
    0%   { opacity:0; transform: translateY(20px) translateX(-12px) scale(.92); }
    80%  { opacity:1; transform: translateY(-2px) translateX(0)      scale(1.05); }
    100% { opacity:1; transform: translateY(0)    translateX(0)      scale(1); }
  }
  .animate-in--me{   animation: messageInRight var(--anim-dur) var(--ease-back) var(--anim-delay) both; }
  .animate-in--them{ animation: messageInLeft  var(--anim-dur) var(--ease-back) var(--anim-delay) both; }

  /*
    ======= 打字效果（給對方訊息用） =======
    - .cursor: 閃爍游標
  */
  .msg__content{ white-space:pre-wrap; }
  .cursor{ display:inline-block; width:1ch; }
  @keyframes blink { 0%,49%{opacity:1} 50%,100%{opacity:0} }
  .cursor::after{ content:"|"; animation: blink 1s step-end infinite; opacity:.7 }

  /* 我方訊息：保留彈入動畫，但拿掉延遲 */
  .no-delay{ animation-delay: 0s !important; }

  /* 無障礙（使用者偏好減少動畫） */
  @media (prefers-reduced-motion: reduce){
    .animate-in--me, .animate-in--them{ animation: none !important; }
  }

  /* 輸入區（固定在底部） */
  .chat__input{ padding:12px; border-top:1px solid var(--border); background:#fff; display:flex; gap:8px; }
  .chat__textbox{ flex:1; padding:10px 12px; border:1px solid var(--border); border-radius:10px; outline:none; }
  .btn{ padding:10px 14px; border:none; border-radius:10px; background:#111827; color:#fff; cursor:pointer; }
  .btn:disabled{ opacity:.5; cursor:not-allowed; }